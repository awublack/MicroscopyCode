This is the code implementing the original method in the FPM paper.
